<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Git - Anotações</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Git";
    var mkdocs_page_input_path = "git.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Anotações</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Welcome to MkDocs</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../amazon/">Amazon</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../banco_de_dados/">Banco de dados</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../bash/">Bash</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../benchmarks/">Benchmarks</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../docker/">Docker</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../firefox/">Firefox</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Git</a>
    <ul class="current">
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="" href="../golang.md">Golang</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../html/">HTML</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../latex/">Latex</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../linux/">Linux</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../mercurial/">Mercurial</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../perl/">Perl</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../python/">Python</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../ruby/">Ruby</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../vim/">Vim</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Anotações</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Git</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Dicas de como se utilizar branches no git.</p>
<h2 id="showing-which-files-have-changed-between-git-branches">Showing which files have changed between git branches</h2>
<p>From <a href="http://stackoverflow.com/questions/822811/showing-which-files-have-changed-between-git-branches">Showing which files have changed between git branches</a> :</p>
<pre><code class="language-Bash">git diff --name-status master..branchName
</code></pre>
<h2 id="git-rename-local-git-branch">Git rename local git branch</h2>
<p>From <a href="http://stackoverflow.com/questions/6591213/rename-local-git-branch">Git rename local git branch</a> :</p>
<pre><code class="language-Bash">git branch -m &lt;oldname&gt; &lt;newname&gt;
# or, if you want to rename the current branch:
git branch -m &lt;newname&gt;
</code></pre>
<h2 id="pushing-local-branch-to-origin">Pushing local branch to origin</h2>
<pre><code class="language-Bash">git push origin &lt;branchName&gt;
</code></pre>
<h2 id="remove-remote-branches">Remove remote branches</h2>
<p>From <a href="http://stackoverflow.com/questions/2003505/delete-a-git-branch-both-locally-and-remotely">Remove remote branches</a> :</p>
<pre><code class="language-Bash">git push origin --delete &lt;branchName&gt; # or
git push origin :&lt;branchName&gt;
</code></pre>
<h1 id="visualization">Visualization</h1>
<h2 id="branches-hierarchy">Branches Hierarchy</h2>
<pre><code class="language-Bash">git log --oneline --decorate --color --graph --all --simplify-by-decoration
# ou
git log --graph --simplify-by-decoration --pretty=format:'%d' --all
</code></pre>
<h2 id="git-log-all-branches">Git log all branches</h2>
<p>From <a href="http://www.lornajane.net/posts/2014/git-log-all-branches">Git log all branches</a> :</p>
<pre><code class="language-Bash">git log --oneline --graph --decorate --all
</code></pre>
<h1 id="moving">Moving</h1>
<h2 id="move-commits-from-one-branch-to-another">Move commits from one branch to another</h2>
<p>From <a href="http://effectif.com/git/move-commit-from-one-branch-to-another">Move commits from one branch to another</a> :</p>
<pre><code class="language-Bash"># This will move commits from master to the new branch
git checkout -b some-feature
git checkout master
git reset --hard HEAD^
git checkout some-feature
</code></pre>
<h2 id="movendo-conteudo-de-uma-branch-para-outra">Movendo conteúdo de uma branch para outra</h2>
<p>De vez em quando não podemos simplesmente mergear uma branch com a outra, pois isso pode trazer algumas modificações indesejadas.
Uma coisa que podemos fazer é crirar um conjunto de patches e transportá-los para a branch onde queremos aplicar as mudanças que foram feitas na outra branch.</p>
<p><strong>Gerando os patches:</strong></p>
<pre><code class="language-Bash">git checkout &lt;SHA-1 do commit que você quer considerar como último&gt;
git format-patch &lt;SHA-1 do commit que você quer utilizar como primeiro&gt;
# Serão gerados vários arquivos .patch
</code></pre>
<p><strong>Aplicando os patches:</strong></p>
<pre><code class="language-Bash"># Primeiramente, mude seu workspace para a branch onde você quer aplicar as mudanças
# e.g.: git checkout production

git am *.patch
# No caso que enfrentei tinha alguns problemas de espaço, final de linha, etc. então utilizei:
git am -3 --ignore-whitespace *.patch
</code></pre>
<p>Caso algum dos patches falhe na sua aplicação basta editar o arquivo, adicioná-lo com <code>git add</code> e dar um <code>git am --continue</code></p>
<h2 id="move-the-most-recent-commit">Move the most recent commit</h2>
<p>From <a href="http://stackoverflow.com/questions/1628563/move-the-most-recent-commits-to-a-new-branch-with-git">Move the most recent commit(s) to a new branch with Git</a> :</p>
<pre><code class="language-Bash">git branch newbranch
git reset --hard HEAD~3 # Go back 3 commits. You *will* lose uncommitted work.
git checkout newbranch
</code></pre>
<h2 id="movendo-um-diretorio-de-um-repositorio-para-outro-preservando-o-historico">Movendo um diretório de um repositório para outro, preservando o histórico!</h2>
<p>Quem nunca começou a mexer em um diretório e depois percebeu que ele precisava ficar em outro repositório, ou até ser um repositório separado (uma biblioteca, por exemplo)? Seus problemas se acabaram-se!! <code>git filter-branch</code> ao resgate!</p>
<p>Para esta receita de bolo queremos:</p>
<ul>
<li>Mover um diretório de um repositório A para um repositório B</li>
</ul>
<p>E temos as seguintes condições:</p>
<ul>
<li>O repositório A contém outras coisas além do diretório que queremos mover</li>
<li>Queremos preservar todo o histórico de commits que envolvam o diretório em questão</li>
</ul>
<p>(depois de fazer um backup do seu repositório, utilizando sua forma favorita)</p>
<p>Na raiz do "repositório A":</p>
<pre><code class="language-Bash">git filter-branch --subdirectory-filter [oDitoCujoDoDiretorioQueQueremosSeparar] -- --all
</code></pre>
<p>If you want your code to be on another directory structure on repository B, execute the following commands still on Repository A:</p>
<pre><code>mkdir -p [new directory location]
mv * [new directory location]
git add .
git commit
</code></pre>
<p>Este lindo comando fará, segundo a documentação, como se o repositório fosse a raíz do repositório e todo o resto, desconhecido.</p>
<p>Já no seu "repositório B":</p>
<pre><code class="language-Bash">git checkout -b new_branch
git remote add branchA [caminhoParaORepositorioA]
git pull branchA master --allow-unrelated-histories # Ao invés de master você pode colocar a branch que estava sendo utilizada no repositório A
git remote rm branchA
git checkout master
git merge --no-ff new_branch
git branch -d new_branch
</code></pre>
<p>Pronto! Agora em seu "repositório B" você terá todo o conteúdo do diretório que estava no "repositório A", e com o histórico preservado!
E isto tudo só foi possível devido às dicas <a href="http://gbayer.com/development/moving-files-from-one-git-repository-to-another-preserving-history/">deste site</a>!
<a href="https://gist.github.com/whistler/de34b77aba2221ed8b2e">This gist</a> has a very similar strategy based on the site above.</p>
<p>A simple bash script with all the steps at once:</p>
<pre><code class="language-bash">#!/usr/bin/env bash

GITHUB_USER=&quot;&quot;
REPO_FROM=&quot;&quot;
REPO_FROM_BRANCH=&quot;master&quot;
DIRECTORY_FROM=&quot;a/b/c/&quot;
REPO_TO=&quot;&quot;
REPO_TO_NEW_BRANCH=&quot;moving&quot;
DIRECTORY_TO=&quot;c/&quot;

git clone git@github.com:${GITHUB_USER}/${REPO_FROM}.git
git clone git@github.com:${GITHUB_USER}/${REPO_TO}.git

cd ${REPO_FROM}
git filter-branch --subdirectory-filter &quot;${DIRECTORY_FROM}&quot; -- --all
mkdir -p &quot;${DIRECTORY_TO}&quot;
mv * &quot;${DIRECTORY_TO}&quot;
git add .
git commit -m &quot;Moving files to new location&quot;

cd ../${REPO_TO}
git checkout -b &quot;${REPO_TO_NEW_BRANCH}&quot;
git remote add repoFrom &quot;../${REPO_FROM}&quot;
git pull repoFrom &quot;${REPO_FROM_BRANCH}&quot; --allow-unrelated-histories
git remote rm repoFrom
git checkout master
git merge --no-ff &quot;${REPO_TO_NEW_BRANCH}&quot;
# git branch -d &quot;${REPO_TO_NEW_BRANCH}&quot;
</code></pre>
<h1 id="how-do-you-squash-commits-into-one-patch-with-git-format-patch">How do you squash commits into one patch with git format-patch?</h1>
<p>With the help of <a href="http://stackoverflow.com/questions/616556/how-do-you-squash-commits-into-one-patch-with-git-format-patch">StackOverflow</a>.</p>
<pre><code class="language-Bash">[(master)]$ git checkout -b tmpsquash
Switched to a new branch &quot;tmpsquash&quot;

[(tmpsquash)]$ git merge --squash newlines
Updating 4d2de39..b6768b2
Fast forward
Squash commit -- not updating HEAD
 test.txt |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

[(tmpsquash)]$ git commit -a -m &quot;My squashed commits&quot;
[tmpsquash]: created 75b0a89: &quot;My squashed commits&quot;
 1 files changed, 2 insertions(+), 0 deletions(-)

[(tmpsquash)]$ git format-patch master
0001-My-squashed-commits.patch
</code></pre>
<h1 id="moving-branch-pointer-without-checkout">Moving branch pointer without checkout</h1>
<p>As stated <a href="http://stackoverflow.com/questions/5471174/git-move-branch-pointer-to-different-commit-without-checkout">here</a> we can use:</p>
<pre><code>git branch -f branch-name new-tip-commit
</code></pre>
<h1 id="git-patch-in-different-directory">Git patch in different directory</h1>
<p>As suggested in <a href="https://stackoverflow.com/questions/16526321/how-to-apply-a-git-patch-to-a-file-with-a-different-name-and-path">How to apply a Git patch to a file with a different name and path? - Stack Overflow</a>:</p>
<pre><code>git format-patch --relative &lt;commit&gt;
</code></pre>
<p>It can be something like: <code>git format-patch --relative -10 HEAD</code></p>
<p>Then apply pointing to the new directory:</p>
<pre><code>git am --directory the/directory/ 0001-patchfile.patch
</code></pre>
<h1 id="merging-two-repositories">Merging two repositories</h1>
<p>How to merge a repository (<code>REPO_TO_DELETE</code>) into another (<code>REPO_TO_KEEP</code>):</p>
<pre><code class="language-bash">#!/usr/bin/env bash

GITHUB_USER=&quot;&quot;
REPO_TO_KEEP=&quot;&quot;
REPO_TO_DELETE=&quot;&quot;

git clone git@github.com:${GITHUB_USER}/${REPO_TO_KEEP}.git
git clone git@github.com:${GITHUB_USER}/${REPO_TO_DELETE}.git

cd ${REPO_TO_DELETE}
mkdir ${REPO_TO_DELETE}
mv * ${REPO_TO_DELETE}
git add .
git commit -a -m &quot;Moving ${REPO_TO_DELETE} project into its own directory

So we can merge into the ${REPO_TO_KEEP} repository with less problems&quot;

cd ../${REPO_TO_KEEP}
git remote add ${REPO_TO_DELETE} ../${REPO_TO_DELETE}
git fetch ${REPO_TO_DELETE}
git checkout -b merging_${REPO_TO_DELETE}_repo
git merge --allow-unrelated-histories ${REPO_TO_DELETE}/master

# Solve any conflicts that appear
# git commit
</code></pre>
<h1 id="deleting-a-git-tag">Deleting a git tag</h1>
<p>From: <a href="https://nathanhoad.net/how-to-delete-a-remote-git-tag">How to: Delete a remote Git tag - Nathan Hoad</a></p>
<ul>
<li>
<p>Delete your local tag:</p>
<p><code>git tag -d 12345</code></p>
</li>
<li>
<p>Remove it from the remote:</p>
<p><code>git push origin :refs/tags/12345</code></p>
</li>
</ul>
<h1 id="deleting-unused-local-branches">Deleting unused local branches</h1>
<pre><code>git branch --merged | egrep -v "(^\*|master|dev)" | xargs git branch -d
</code></pre>
<h1 id="purging-a-file-from-your-repositorys-history">Purging a file from your repository's history</h1>
<p>Instructions from <a href="https://help.github.com/articles/removing-sensitive-data-from-a-repository/">Removing sensitive data from a repository - User Documentation</a></p>
<p>Remove it from the history:</p>
<pre><code class="language-bash">git filter-branch --force --index-filter 'git rm --cached --ignore-unmatch PATH-TO-YOUR-FILE-WITH-SENSITIVE-DATA' --prune-empty --tag-name-filter cat -- --all
</code></pre>
<p>Add it to gitignore:</p>
<pre><code class="language-bash">echo &quot;YOUR-FILE-WITH-SENSITIVE-DATA&quot; &gt;&gt; .gitignore
git add .gitignore
git commit -m &quot;Add YOUR-FILE-WITH-SENSITIVE-DATA to .gitignore&quot;
</code></pre>
<p>Force push:</p>
<pre><code class="language-bash">git push origin --force --tags
</code></pre>
<h1 id="how-to-work-with-a-encrypted-repository-using-git-crypt">How to work with a encrypted repository using git-crypt</h1>
<p><a href="https://github.com/AGWA/git-crypt/">git-crypt repo</a></p>
<ul>
<li>Clone it
    <code>git clone git@github.com:AGWA/git-crypt.git</code></li>
<li>Install it<ul>
<li><code>make &amp;&amp; make install</code></li>
<li>Make sure that you have <code>g++</code> installed</li>
</ul>
</li>
</ul>
<h2 id="to-generate-a-key">To generate a key</h2>
<pre><code>cd $(mktemp -d); git init; git-crypt init; git-crypt export-key ~/git-crypt.key; cd
</code></pre>
<p>Don't forget to secure your key in a safe place.</p>
<h2 id="configuring-your-repository-to-encrypt-all-files">Configuring your repository to encrypt all files</h2>
<p>In a repository create and commit a <code>.gitattributes</code> file with this content:</p>
<pre><code>/** filter=git-crypt diff=git-crypt
/public/** !filter !diff
.gitattributes !filter !diff
.gitmodules !filter !diff
.git* !filter !diff
</code></pre>
<p>After the <code>.gitattributes</code> file is commited, do the following steps:</p>
<pre><code>git-crypt unlock ~/git-crypt.key
git-crypt status -f
</code></pre>
<p>Then commit your changes.</p>
<p>On all new clones of this repository you'll need to unlock it:</p>
<pre><code>git-crypt unlock ~/git-crypt.key
...do your stuff...
git-crypt status # to check if all files are encrypted (-f to fix)
git add .
git commit
git push
</code></pre>
<p><strong>CAUTION</strong></p>
<p>When backuping the repository do not copy it to another place, <code>clone</code> it.
When <code>git-crypt</code> <code>unlocks</code> a repository it creates a git-crypt directory inside <code>.git</code> which contains your key.</p>
<p><strong>CAUTION</strong></p>
<h1 id="references">References</h1>
<ul>
<li><a href="https://stackoverflow.com/questions/2456954/git-encrypt-decrypt-remote-repository-files-while-push-pull/45047100#45047100">encryption - git encrypt/decrypt remote repository files while push/pull - Stack Overflow</a></li>
<li><a href="http://www.twinbit.it/en/blog/storing-sensitive-data-git-repository-using-git-crypt">Storing sensitive data in a git repository using git-crypt | Technology | Blog | Twinbit</a></li>
<li><a href="https://github.com/AGWA/git-crypt/issues/76">Encrypting all by default, then exclude... · Issue #76 · AGWA/git-crypt · GitHub</a></li>
</ul>
<h1 id="exporting-your-repository">Exporting your repository</h1>
<p>To export your repository to another person you have two options: <code>git archive</code> and <code>git bundle</code></p>
<h2 id="git-archive">Git archive</h2>
<p>With <code>git archive</code> you export the repository but only the files on <code>HEAD</code>, without the history.</p>
<p>At the repository's root:</p>
<pre><code>git archive -o ${PWD##*/}-$(date +%Y%m%d).zip HEAD
</code></pre>
<h2 id="git-bundle">Git bundle</h2>
<p>With <code>git bundle</code> you export the repository including the entire history.</p>
<p>At the repository's root, create the bundle file:</p>
<pre><code>git bundle create ${PWD##*/}-$(date +%Y%m%d).bundle --all
</code></pre>
<p>After sending this file to another person s/he can clone it and start analyzing it:</p>
<pre><code>git clone repositry.bundle
</code></pre>
<p>﻿Dicas gerais sobre o git.</p>
<h2 id="how-can-i-determine-the-url-that-a-local-git-repo-was-originally-cloned-from">How can I determine the url that a local git repo was originally cloned from?</h2>
<p>From <a href="http://stackoverflow.com/questions/4089430/how-can-i-determine-the-url-that-a-local-git-repo-was-originally-cloned-from">How can I determine the url that a local git repo was originally cloned from?</a> :</p>
<pre><code class="language-Bash"># If referential integrity has been broken:
git config --get remote.origin.url
# If referential integrity is intact:
git remote show origin
</code></pre>
<h2 id="problema-ao-se-fazer-push-para-um-repositorio-non-bare">Problema ao se fazer push para um repositório "non-bare"</h2>
<pre><code class="language-Bash">$ git push
Counting objects: 20, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (17/17), done.
Writing objects: 100% (18/18), 2.69 KiB | 0 bytes/s, done.
Total 18 (delta 9), reused 0 (delta 0)
remote: error: refusing to update checked out branch: refs/heads/master
remote: error: By default, updating the current branch in a non-bare repository
remote: error: is denied, because it will make the index and work tree inconsistent
remote: error: with what you pushed, and will require 'git reset --hard' to match
remote: error: the work tree to HEAD.
remote: error:
remote: error: You can set 'receive.denyCurrentBranch' configuration variable to
remote: error: 'ignore' or 'warn' in the remote repository to allow pushing into
remote: error: its current branch; however, this is not recommended unless you
remote: error: arranged to update its work tree to match what you pushed in some
remote: error: other way.
remote: error:
remote: error: To squelch this message and still keep the default behaviour, set
remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse'.
To /home/hugo/Dropbox/workplace/eve_grabber
 ! [remote rejected] master -&gt; master (branch is currently checked out)
error: failed to push some refs to '/home/hugo/Dropbox/workplace/eve_grabber'
</code></pre>
<p>Com a ajuda do <a href="http://stackoverflow.com/questions/2816369/git-push-error-remote-rejected-master-master-branch-is-currently-checked">stack overflow</a>:</p>
<p>At the remote repo:</p>
<pre><code class="language-Bash">git config --bool core.bare true
</code></pre>
<p>Then delete all the files except .git in that folder. And then you will be able to perform git push to the remote repository without any errors.</p>
<h2 id="creating-a-bare-repository-from-a-normal-one">Creating a bare repository from a normal one</h2>
<p>From <a href="https://stackoverflow.com/a/2200662">version control - How to convert a normal Git repository to a bare one? - Stack Overflow</a>:</p>
<pre><code>cd repo
mv .git ../repo.git # renaming just for clarity
cd ..
rm -fr repo
cd repo.git
git config --bool core.bare true
</code></pre>
<h2 id="gerando-patches">Gerando Patches</h2>
<p>Dica do <a href="https://ariejan.net/2009/10/26/how-to-create-and-apply-a-patch-with-git/">How to create and apply a patch with Git</a>:</p>
<h3 id="para-se-gerar-o-patch">Para se gerar o patch:</h3>
<pre><code class="language-Bash">git format-patch against_branch_name --stdout &gt; name_of.patch
</code></pre>
<p>Outra forma de se gerar o patch é com <code>git diff</code>:</p>
<pre><code class="language-Bash">git diff sha1..sha2 &gt; name_of.patch
</code></pre>
<h3 id="para-se-aplicar-o-patch">Para se aplicar o patch:</h3>
<pre><code class="language-Bash">git apply --stat name_of.patch
</code></pre>
<p>Assim, ele só irá mostrar como será a aplicação do patch, não aplicará de verdade.</p>
<p>Para realmente se aplicar o patch devemos chamar</p>
<pre><code class="language-Bash">git am name_of.patch
</code></pre>
<h2 id="submodules">Submodules</h2>
<p>Atualizando todos os submodules:</p>
<pre><code class="language-Bash">git submodule update --init --recursive
</code></pre>
<h2 id="how-to-grep-search-committed-code-in-the-git-history">How to grep (search) committed code in the git history?</h2>
<pre><code class="language-Bash">git grep [regexp] $(git rev-list --all)
</code></pre>
<p>or</p>
<pre><code class="language-Bash">git log -S&quot;search term&quot;
</code></pre>
<h2 id="how-to-grep-commit-messages">How to grep commit messages</h2>
<pre><code class="language-bash">git log --grep &quot;search term&quot;
</code></pre>
<p>On all branches</p>
<pre><code>git log --all --grep=&quot;search term&quot;
</code></pre>
<h1 id="add-only-non-whitespace-changes">Add only non-whitespace changes</h1>
<p>Suponha que o seu editor tenha feito mudanças nos whitespaces/tabs, para apenas adicionar ao staging as mudanças de verdade:</p>
<pre><code>git diff -w --no-color &lt;arquivo&gt; | git apply --cached --ignore-whitespace
</code></pre>
<h1 id="temporarily-stop-watching-a-file">Temporarily stop watching a file</h1>
<pre><code>git update-index --assume-unchanged &lt;file&gt;
</code></pre>
<p>Now the file, even if modified, will not appear in a git status.</p>
<p>To undo it:</p>
<pre><code>git update-index --no-assume-unchanged &lt;file&gt;
</code></pre>
<p>To list all the files that are "hidden" in this way:</p>
<pre><code>git ls-files -v | grep '^h'
</code></pre>
<p>With the help of <a href="http://stackoverflow.com/questions/17195861/undo-git-update-index-assume-unchanged-file">StackOverflow</a></p>
<h1 id="discovering-when-text-was-modified-in-a-file">Discovering when text was modified in a file</h1>
<p>With the help of <a href="http://stackoverflow.com/questions/12591247/find-when-line-was-deleted">StackOverflow</a>:</p>
<pre><code>git log -c -S'missingtext' /path/to/file
</code></pre>
<h1 id="pushing-to-a-remote-branch-with-a-different-name">Pushing to a Remote Branch with a Different Name</h1>
<pre><code>git push origin local-name:remote-name
</code></pre>
<p>Tip from https://penandpants.com/2013/02/07/git-pushing-to-a-remote-branch-with-a-different-name/</p>
<h1 id="analisando-a-historia">Analisando a história</h1>
<h2 id="mudancas-entre-dois-changests">Mudanças entre dois changests</h2>
<p>Apenas os arquivos que foram mudados:</p>
<pre><code class="language-Bash">git diff --name-only sha1..sha2
# ou
git diff --name-only HEAD~10..HEAD~5
</code></pre>
<p>O conteúdo do que foi mudado:</p>
<pre><code class="language-Bash">git diff sha1..sha2
# ou
git diff HEAD~10..HEAD~5
</code></pre>
<h2 id="get-all-files-that-have-been-modified-between-two-git-branches">Get all files that have been modified between two git branches</h2>
<p>From <a href="https://stackoverflow.com/questions/10641361/get-all-files-that-have-been-modified-in-git-branch#10641810">Get all files that have been modified in git branch - Stack Overflow</a>:</p>
<pre><code>git diff --name-only &lt;notMainDev&gt; $(git merge-base &lt;notMainDev&gt; &lt;mainDev&gt;)
</code></pre>
<p>An example if you are on a branch and want to compare with master:</p>
<pre><code>git diff --name-only HEAD $(git merge-base master HEAD)
</code></pre>
<h2 id="branches-and-commits-between-two-commits">Branches and commits between two commits</h2>
<ul>
<li>
<p>All commits between two commits (only the direct path)</p>
<p>git log --ancestry-path <root>..<descendant></p>
</li>
<li>
<p>Current branches that are children of another</p>
<p>git branch --contains <root branch></p>
</li>
</ul>
<h1 id="revert-a-commit-alredy-pushed-to-a-remote-repository">Revert a commit alredy pushed to a remote repository</h1>
<p>From <a href="http://christoph.ruegg.name/blog/git-howto-revert-a-commit-already-pushed-to-a-remote-reposit.html">this blog entry</a> there are two good ways:</p>
<pre><code class="language-Bash">git push origin +commit_sha^:master
</code></pre>
<p>or (The one I used):</p>
<pre><code class="language-Bash">git reset HEAD^ --hard
git push origin -f
</code></pre>
<h1 id="making-git-forget-about-a-file-that-was-tracked-but-is-now-in-gitignore">Making git “forget” about a file that was tracked but is now in .gitignore</h1>
<p>.gitignore will prevent untracked files from being added (without an add -f) to the set of files tracked by git, however git will continue to track any files that are already being tracked.</p>
<p>To stop tracking a file you need to remove it from the index. This can be achieved with this command.</p>
<pre><code class="language-Bash">git rm --cached &lt;file&gt;
</code></pre>
<p>The removal of the file from the head revision will happen on the next commit.</p>
<h1 id="edit-an-incorrect-commit-message-in-git">Edit an incorrect commit message in Git</h1>
<p>With hints from <a href="http://stackoverflow.com/questions/179123/edit-an-incorrect-commit-message-in-git">StackOverflow</a>:</p>
<ol>
<li>
<p>If the commit you want to fix isn’t the most recent one:</p>
<p>If you want to fix several flawed commits, pass the parent of the oldest one of them.
<code>git rebase --interactive $parent_of_flawed_commit</code></p>
</li>
<li>
<p>An editor will come up, with a list of all commits since the one you gave.</p>
<ol>
<li>Change <code>pick</code> to <code>reword</code> (or on old versions of Git, to <em>edit</em>) in front of any commits you want to fix.</li>
<li>Once you save, Git will replay the listed commits.</li>
</ol>
</li>
<li>
<p>For each commit you want to <code>reword</code>, Git will drop you back into your editor. For each commit you want to edit, Git drops you into the shell. If you’re in the shell:</p>
<ol>
<li>Change the commit in any way you like.</li>
<li><code>git commit --amend</code></li>
<li><code>git rebase --continue</code></li>
</ol>
</li>
</ol>
<p>Most of this sequence will be explained to you by the output of the various commands as you go. It’s very easy, you don’t need to memorise it – just remember that <code>git rebase --interactive</code> lets you correct commits no matter how long ago they were.</p>
<h1 id="changing-the-whole-history">Changing the whole history</h1>
<p>You may want to <code>rebase</code> from the beginning of your repository. For doing that the <code>--root</code> flag is very useful:</p>
<pre><code>git rebase -i --root
</code></pre>
<h1 id="re-creating-the-first-commit">Re-creating the first commit</h1>
<pre><code>git checkout -b new-master
git reset --hard &lt;First commit SHA&gt;
git update-ref -d HEAD
# Now remove all files from stage
git commit --allow-empty
git merge --no-ff &lt;other branch&gt;
</code></pre>
<p>Using the help from <a href="https://stackoverflow.com/questions/6632191/how-to-revert-initial-git-commit#answer-6637891">How to revert initial git commit? - Stack Overflow</a></p>
<h1 id="changelog-of-what-has-been-added-to-your-project-since-your-last-release">Changelog of what has been added to your project since your last release</h1>
<p>It’s time to email your mailing list of people who want to know what’s happening in your project.</p>
<pre><code>$ git shortlog --no-merges base...latest
</code></pre>
<p>More info at <a href="https://git-scm.com/book/en/v2/Distributed-Git-Maintaining-a-Project#The-Shortlog">The Shortlog</a>.</p>
<h1 id="getting-all-submodules-recursively">Getting all submodules recursively</h1>
<pre><code>git submodule foreach --recursive git submodule update --init
</code></pre>
<p>Undoing mistakes</p>
<h1 id="find-and-restore-a-deleted-file">Find and restore a deleted file</h1>
<p>With the help of <a href="http://stackoverflow.com/questions/953481/find-and-restore-a-deleted-file-in-a-git-repo">StackOverflow</a>:</p>
<p>Find the last commit that affected the given path. As the file isn't in the HEAD commit, this commit must have deleted it.</p>
<pre><code class="language-bash">git rev-list -n 1 HEAD -- &lt;file_path&gt;
</code></pre>
<p>Then checkout the version at the commit before, using the caret (^) symbol:</p>
<pre><code class="language-bash">git checkout &lt;deleting_commit&gt;^ -- &lt;file_path&gt;
</code></pre>
<p>Or in one command, if <code>$file</code> is the file in question.</p>
<pre><code class="language-bash">git checkout $(git rev-list -n 1 HEAD -- &quot;$file&quot;)^ -- &quot;$file&quot;
</code></pre>
<p><strong>HINT:</strong> Use <code>git log --diff-filter=D --summary</code> to get all the commits which have deleted files and the files deleted;</p>
<p><strong>HINT 2:</strong> <a href="http://blog.kablamo.org/2013/12/08/git-restore/">from here</a> How to search the contents of deleted files</p>
<p>Lets say I don’t remember the filename of that file I deleted in a fit of cleanup passion. I do remember the name of one of the functions in it though. Here is how to deal with that. Search the contents of all files that have ever existed in git for a string:</p>
<pre><code class="language-Bash">git log --summary -S&lt;string&gt; [&lt;path/to/file&gt;] [--since=2009.1.1] [--until=2010.1.1]
</code></pre>
<p>Another way to do this:</p>
<pre><code class="language-Bash">git rev-list --all | xargs git grep 'string'
</code></pre>
<h1 id="undoing-a-git-rebase">Undoing a git rebase</h1>
<p>Sometimes we want to undo a bad <code>git rebase</code>, hints from <a href="http://stackoverflow.com/questions/134882/undoing-a-git-rebase">StackOverflow</a> :</p>
<ul>
<li>First, we have to discover where is the head commit of the branch as it was immediately before the rebase started in the reflog:</li>
</ul>
<pre><code class="language-Bash">git reflog
</code></pre>
<p>or</p>
<pre><code class="language-Bash">git log -g
</code></pre>
<ul>
<li>Then, reset the current branch to it (with the usual caveats about being absolutely sure before reseting with the --hard option):</li>
</ul>
<pre><code class="language-Bash"># Suppose the old commit was HEAD@{5} in the ref log
git reset --hard HEAD@{5}
</code></pre>
<p><strong>HINT:</strong> Just in case, make a backup first: <code>git tag BACKUP</code>. You can return to it if something goes wrong: <code>git reset --hard BACKUP</code></p>
<h2 id="desfazendo-o-ultimo-commit">Desfazendo o último commit</h2>
<pre><code class="language-Bash">git reset --soft HEAD~1
</code></pre>
<h1 id="desfazendo-o-primeiro-commit-de-um-repositorio">Desfazendo o primeiro commit de um repositório</h1>
<pre><code class="language-Bash">git update-ref -d HEAD
</code></pre>
<h1 id="undo-a-git-merge">Undo a git merge</h1>
<p>From <a href="http://stackoverflow.com/questions/2389361/undo-a-git-merge">Undo a git merge</a> :</p>
<pre><code class="language-Bash">git reset --hard commit_sha
# ou
git reset --hard HEAD~5 #will get you back 5 commits.
# ou
git reset --merge ORIG_HEAD
</code></pre>
<h2 id="how-to-revert-a-merge-that-is-already-pushed-to-remote">How to revert a merge that is already pushed to remote?</h2>
<p>From this <a href="http://stackoverflow.com/questions/7099833/how-to-revert-a-merge-commit-thats-already-pushed-to-remote-branch">StackOverflow hint</a>:</p>
<pre><code>git revert merge_sha -m [1,2]
</code></pre>
<p>To discover if you have to use 1 or 2 do a <code>git log</code> on the merge_sha, then 1 will represent the left SHA and 2 the right SHA that appear in the 'Merge' line.</p>
<h1 id="removing-sensitive-files-from-old-commits">Removing sensitive files from old commits</h1>
<p>From <a href="https://help.github.com/articles/remove-sensitive-data/">Remove sensitive data - User Documentation</a>:</p>
<pre><code>git filter-branch --force --index-filter 'git rm --cached --ignore-unmatch PATH-TO-YOUR-FILE-WITH-SENSITIVE-DATA' --prune-empty --tag-name-filter cat -- --all
</code></pre>
<p>Then, to remove the newly generated 'refs/original' reference and clear the reflog and do a garbage collect:</p>
<pre><code>git for-each-ref --format='delete %(refname)' refs/original | git update-ref --stdin
git reflog expire --expire=now --all
git gc --prune=now
</code></pre>
<h1 id="going-way-back-to-the-origin-of-time">Going way back to the origin of time</h1>
<pre><code>git checkout --orphan branch_name
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../html/" class="btn btn-neutral float-right" title="HTML">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../firefox/" class="btn btn-neutral" title="Firefox"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../firefox/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../html/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
